const btn=document.querySelector(".addCard"),modal=document.querySelector(".popup"),addCardBtn=document.querySelector(".addCardBtn"),task=document.querySelector(".task"),development=document.querySelector(".development"),executor=document.querySelector(".executor"),toDo=document.querySelector(".toDo"),doing=document.querySelector(".doing"),done=document.querySelector(".done"),boardItems=document.querySelectorAll(".board__item"),boardDel=document.querySelector(".board__del > h2"),scroll=calcScroll();let htmlCards,cards=[];class Card{constructor(e,t,d,r="toDo",a,o=!1){this.task=e,this.development=t,this.executor=d,this.status=r,this.id=a,this.active=o}}function cardsInitialisation(){localStorage.getItem("cardsList")&&(cards=[...JSON.parse(localStorage.getItem("cardsList"))]),printAllCard(cards)}function saveToLocalStorage(){localStorage.setItem("cardsList",JSON.stringify(cards))}function dragstart(e){setTimeout(()=>{this.classList.add("hideCard")},0),cards.forEach((e,t)=>{this.id==e.id&&(cards[t].active=!0)})}function dragend(e){this.classList.remove("hideCard"),cards.forEach((e,t)=>{this.id==e.id&&(cards[t].active=!1)})}function dragover(e){e.preventDefault()}function dragenter(e){e.target==boardDel&&boardDel.classList.add("board__del_hovered"),e.target!==this&&this.querySelector(".plug").classList.add("hovered")}function dragleave(e){e.target==boardDel&&boardDel.classList.remove("board__del_hovered"),e.target!==this&&this.querySelector(".plug").classList.remove("hovered")}function drop(e){cards.forEach((e,t)=>{!0===e.active&&(cards[t].status=this.classList.value.split(" ")[1]),cards[t].active=!1}),boardItems.forEach(e=>{e.querySelector(".plug").classList.remove("hovered")}),printAllCard(cards)}function dropDel(e){cards.forEach((e,t)=>{!0===e.active&&cards.splice(t,1)}),boardDel.classList.remove("board__del_hovered"),printAllCard(cards)}function printAllCard(e){toDo.querySelector("div").innerHTML="",doing.querySelector("div").innerHTML="",done.querySelector("div").innerHTML="",saveToLocalStorage(),cards.forEach(e=>printCard(e)),htmlCards=document.querySelectorAll(".card"),htmlCards.forEach(e=>{e.addEventListener("dragstart",dragstart),e.addEventListener("dragend",dragend)})}function printCard(e){document.querySelector("."+e.status+" > div").innerHTML+=`\n        <div class="card" draggable="true" id=${e.id}>\n            <div class="card__task">\n                    <p>${e.task}</p>\n                </div>\n                <div class="card__department">\n                    <h3>${e.development}</h3>\n                </div>\n                <div class="card__executor">\n                    <h3>${e.executor}</h3>\n            </div>\n        </div>`}function openModal(){modal.style.display="block",document.body.style.overflow="hidden",document.body.style.marginRight=(document.body.clientHeight>document.documentElement.clientHeight?scroll:0)+"px"}function closeModal(){modal.style.display="none",document.body.style.overflow="",document.body.style.marginRight="0px"}function calcScroll(){let e=document.createElement("div");e.style.width="50px",e.style.height="50px",e.style.overflowY="scroll",e.style.visibility="hidden",document.body.appendChild(e);let t=e.offsetWidth-e.clientWidth;return e.remove(),t}cardsInitialisation(),btn.addEventListener("click",e=>{e.target&&e.preventDefault(),openModal()}),modal.addEventListener("click",e=>{e.target===modal&&closeModal()}),addCardBtn.addEventListener("click",e=>{task.value&&development.value&&executor.value&&(cards.push(new Card(task.value,development.value,executor.value,"toDo",cards.length?cards[cards.length-1].id+1:1)),printAllCard(cards),task.value="",development.value="",executor.value="",closeModal())}),boardItems.forEach(e=>{e.addEventListener("dragover",dragover),e.addEventListener("dragenter",dragenter),e.addEventListener("dragleave",dragleave),e.addEventListener("drop",drop)}),boardDel.addEventListener("dragover",dragover),boardDel.addEventListener("dragenter",dragenter),boardDel.addEventListener("dragleave",dragleave),boardDel.addEventListener("drop",dropDel);