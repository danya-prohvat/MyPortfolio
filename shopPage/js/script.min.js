let container=document.querySelector(".main-content__content__items"),pagination=document.querySelector(".main-content__content__pagination > ul"),clearList=document.querySelector(".main-content__content__button > button"),input=document.querySelector(".main-content__content__button > input"),state={},globalCurrentPage=1;const request=()=>{fetch("index.json").then(e=>e.json()).then(e=>{state=[...e],console.log(state),globalCurrentPage=1,render()})};function printPagination(e){if(pagination.innerHTML="",state){if(8*e-8>=state.length)return globalCurrentPage--,render();for(let t=1;t<=Math.ceil(state.length/8);t++)pagination.innerHTML+=`\n        <li class="${t===e?"main-content__content__pagination_active":""}">${t}</li>\n        `}}function printCollection(e){if(container.innerHTML="",0!=state)for(let t=8*e-8;t<state.length&&t<8*e;t++)container.innerHTML+=`\n        <div class="main-content__content__items__item">\n            <div class="main-content__content__items__item__img">\n                <img src="img/${state[t].photo}" alt="">\n            </div>\n            <div class="main-content__content__items__item__text">\n                <hr>\n                    <h3>${state[t].name}</h3>\n                    <p>${state[t].price} <span>${state[t].lowerPrice}</span></p>\n            </div>\n            <div class="main-content__content__items__item__buttons">\n                <div><i class="fa fa-trash"></i></div>\n                <div><i class="fa fa-shopping-cart"></i></div>\n            </div>\n        </div>`}function startObserving(){pagination.addEventListener("click",paginationObserver),container.querySelectorAll(".fa-trash").forEach(e=>e.parentElement.addEventListener("click",delObserver)),clearList.addEventListener("click",clearButtonObserver),input.addEventListener("input",searchObserver)}function stopObserving(){pagination.removeEventListener("click",paginationObserver),container.querySelectorAll(".fa-trash").forEach(e=>e.parentElement.removeEventListener("click",delObserver)),clearList.removeEventListener("click",clearButtonObserver),input.removeEventListener("input",searchObserver)}function paginationObserver(e){"LI"===e.target.tagName&&(globalCurrentPage=+e.target.textContent,render())}function delObserver(e){state.forEach((t,n)=>{t.name===e.target.parentElement.parentElement.querySelector(".main-content__content__items__item__text > h3").textContent&&(state.splice(n,1),render())})}function clearButtonObserver(){request(),input.value=""}function searchObserver(e){let t=[];fetch("index.json").then(e=>e.json()).then(n=>{state=[...n],console.log(state),globalCurrentPage=1,state.forEach((n,r)=>{e.target.value.toLowerCase()===n.name.slice(0,e.target.value.length).toLowerCase()&&t.push({...n})}),state=[...t],render()})}function render(){stopObserving(),printPagination(globalCurrentPage),printCollection(globalCurrentPage),startObserving()}request();